---

title: Data

keywords: fastai
sidebar: home_sidebar

summary: "Functions used to create pytorch `DataSet`s and `DataLoader`s."
description: "Functions used to create pytorch `DataSet`s and `DataLoader`s."
nb_path: "80_data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 80_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TestData" class="doc_header"><code>class</code> <code>TestData</code><a href="https://github.com/sachinruk/torchlife/tree/master/torchlife/data.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TestData</code>(<strong><code>t</code></strong>:<code>array</code>, <strong><code>b</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>x</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>t_scaler</code></strong>:<code>MaxAbsScaler</code>=<em><code>None</code></em>, <strong><code>x_scaler</code></strong>:<code>StandardScaler</code>=<em><code>None</code></em>) :: <code>Dataset</code></p>
</blockquote>
<p>Create pyTorch Dataset
parameters:</p>
<ul>
<li>t: time elapsed</li>
<li>b: (optional) breakpoints where the hazard is different to previous segment of time.
<strong>Must include 0 as first element and the maximum time as last element</strong></li>
<li>x: (optional) features</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Data" class="doc_header"><code>class</code> <code>Data</code><a href="https://github.com/sachinruk/torchlife/tree/master/torchlife/data.py#L80" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Data</code>(<strong><code>t</code></strong>:<code>array</code>, <strong><code>e</code></strong>:<code>array</code>, <strong><code>b</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>x</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>t_scaler</code></strong>:<code>MaxAbsScaler</code>=<em><code>None</code></em>, <strong><code>x_scaler</code></strong>:<code>StandardScaler</code>=<em><code>None</code></em>) :: <a href="/torchlife/data.html#TestData"><code>TestData</code></a></p>
</blockquote>
<p>Create pyTorch Dataset
parameters:</p>
<ul>
<li>t: time elapsed</li>
<li>e: (death) event observed. 1 if observed, 0 otherwise.</li>
<li>b: (optional) breakpoints where the hazard is different to previous segment of time.</li>
<li>x: (optional) features</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TestDataFrame" class="doc_header"><code>class</code> <code>TestDataFrame</code><a href="https://github.com/sachinruk/torchlife/tree/master/torchlife/data.py#L102" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TestDataFrame</code>(<strong><code>df</code></strong>:<a href="/torchlife/data.html#DataFrame"><code>DataFrame</code></a>, <strong><code>b</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>t_scaler</code></strong>:<code>MaxAbsScaler</code>=<em><code>None</code></em>, <strong><code>x_scaler</code></strong>:<code>StandardScaler</code>=<em><code>None</code></em>) :: <a href="/torchlife/data.html#TestData"><code>TestData</code></a></p>
</blockquote>
<p>Wrapper around Data Class that takes in a dataframe instead
parameters:</p>
<ul>
<li>df: dataframe. **Must have t (time) and e (event) columns, other cols optional.</li>
<li>b: breakpoints of time (optional)</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DataFrame" class="doc_header"><code>class</code> <code>DataFrame</code><a href="pandas/core/frame.py#L319" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DataFrame</code>(<strong><code>data</code></strong>=<em><code>None</code></em>, <strong><code>index</code></strong>:<code>Optional</code>[<code>Collection</code>[<code>T_co</code>]]=<em><code>None</code></em>, <strong><code>columns</code></strong>:<code>Optional</code>[<code>Collection</code>[<code>T_co</code>]]=<em><code>None</code></em>, <strong><code>dtype</code></strong>:<code>Union</code>[<code>str</code>, <code>dtype</code>, <code>ForwardRef('ExtensionDtype')</code>, <code>NoneType</code>]=<em><code>None</code></em>, <strong><code>copy</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <code>NDFrame</code></p>
</blockquote>
<p>Two-dimensional, size-mutable, potentially heterogeneous tabular data.</p>
<p>Data structure also contains labeled axes (rows and columns).
Arithmetic operations align on both row and column labels. Can be
thought of as a dict-like container for Series objects. The primary
pandas data structure.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>data : ndarray (structured or homogeneous), Iterable, dict, or DataFrame
    Dict can contain Series, arrays, constants, or list-like objects.</p>

<pre><code>.. versionchanged:: 0.23.0
   If data is a dict, column order follows insertion-order for
   Python 3.6 and later.

.. versionchanged:: 0.25.0
   If data is a list of dicts, column order follows insertion-order
   for Python 3.6 and later.

</code></pre>
<p>index : Index or array-like
    Index to use for resulting frame. Will default to RangeIndex if
    no indexing information part of input data and no index provided.
columns : Index or array-like
    Column labels to use for resulting frame. Will default to
    RangeIndex (0, 1, 2, ..., n) if no column labels are provided.
dtype : dtype, default None
    Data type to force. Only a single dtype is allowed. If None, infer.
copy : bool, default False
    Copy data from inputs. Only affects DataFrame / 2d ndarray input.</p>
<h2 id="See-Also">See Also<a class="anchor-link" href="#See-Also"> </a></h2><p>DataFrame.from_records : Constructor from tuples, also record arrays.
DataFrame.from_dict : From dicts of Series, arrays, or dicts.
read_csv
read_table
read_clipboard</p>
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><p>Constructing DataFrame from a dictionary.</p>
<blockquote><blockquote><blockquote><p>d = {'col1': [1, 2], 'col2': [3, 4]}
df = pd.DataFrame(data=d)
df
   col1  col2
0     1     3
1     2     4</p>
</blockquote>
</blockquote>
</blockquote>
<p>Notice that the inferred dtype is int64.</p>
<blockquote><blockquote><blockquote><p>df.dtypes
col1    int64
col2    int64
dtype: object</p>
</blockquote>
</blockquote>
</blockquote>
<p>To enforce a single dtype:</p>
<blockquote><blockquote><blockquote><p>df = pd.DataFrame(data=d, dtype=np.int8)
df.dtypes
col1    int8
col2    int8
dtype: object</p>
</blockquote>
</blockquote>
</blockquote>
<p>Constructing DataFrame from numpy ndarray:</p>
<blockquote><blockquote><blockquote><p>df2 = pd.DataFrame(np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]]),
...                    columns=['a', 'b', 'c'])
df2
   a  b  c
0  1  2  3
1  4  5  6
2  7  8  9</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create iterable data loaders/ fastai databunch using above:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_db" class="doc_header"><code>create_db</code><a href="https://github.com/sachinruk/torchlife/tree/master/torchlife/data.py#L136" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_db</code>(<strong><code>df</code></strong>:<a href="/torchlife/data.html#DataFrame"><code>DataFrame</code></a>, <strong><code>b</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>train_p</code></strong>:<code>float</code>=<em><code>0.8</code></em>, <strong><code>bs</code></strong>:<code>int</code>=<em><code>128</code></em>)</p>
</blockquote>
<p>Take dataframe and split into train, test, val (optional)
and convert to Fastai databunch</p>
<p>parameters:</p>
<ul>
<li>df: pandas dataframe</li>
<li>b(optional): breakpoints of time. <strong>Must include 0 as first element and the maximum time as last element</strong></li>
<li>train_p: training percentage</li>
<li>bs: batch size</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_test_dl" class="doc_header"><code>create_test_dl</code><a href="https://github.com/sachinruk/torchlife/tree/master/torchlife/data.py#L161" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_test_dl</code>(<strong><code>df</code></strong>:<a href="/torchlife/data.html#DataFrame"><code>DataFrame</code></a>, <strong><code>b</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>t_scaler</code></strong>:<code>MaxAbsScaler</code>=<em><code>None</code></em>, <strong><code>x_scaler</code></strong>:<code>StandardScaler</code>=<em><code>None</code></em>, <strong><code>bs</code></strong>:<code>int</code>=<em><code>128</code></em>)</p>
</blockquote>
<p>Take dataframe and return a pytorch dataloader.
parameters:</p>
<ul>
<li>df: pandas dataframe</li>
<li>b: breakpoints of time (optional)</li>
<li>bs: batch size</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_breakpoints" class="doc_header"><code>get_breakpoints</code><a href="https://github.com/sachinruk/torchlife/tree/master/torchlife/data.py#L177" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_breakpoints</code>(<strong><code>df</code></strong>:<a href="/torchlife/data.html#DataFrame"><code>DataFrame</code></a>, <strong><code>percentiles</code></strong>:<code>list</code>=<em><code>[20, 40, 60, 80]</code></em>)</p>
</blockquote>
<p>Gives the times at which death events occur at given percentile
parameters:
df - must contain columns 't' (time) and 'e' (death event)
percentiles - list of percentages at which breakpoints occur (do not include 0 and 100)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

